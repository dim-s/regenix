# Настройка

Regenix легкий в настройке фреймворк. Существует несколько стандартных файлов для конфигурирования приложения:

  1. **Главная конфигурация** - содержит главные опции приложения, именуется как `application.conf`
  2. **Конфигурация зависимостей** - содержит все зависимости для моделей и asset, именуется как `deps.json`
  3. **Конфигурация роутинга (ЧПУ)** - содержит правила ЧПУ для урл приложения, именуется как `route`.
  4. **Доп-конфиги роутинга** - дополнительные конфигурации для включения их в основной файл конфигурации роутинга.
  5. **Конфигурация анализатора** - конфигурация для статического анализатора кода.

Все конфигурации находятся в директории `/apps/<ваше_приложение>/conf/`.

---

## Главная конфигурация

Главная конфигурация располагается в файле `conf/application.conf` и
выглядит как ini файл, только без секций. Конфиг также может содержать комментарии.
Для примера:

    # комментарий
    app.mode = dev
    
    # ...
    app.rules = /sub/
    
    # и т.д.
    dev.app.rules = /

Опции бывают нескольких типов:

  1. _string_ - обыкновенная строка
  2. _boolean_ - значение правда/ложь, да/нет, true/false. true - `on` или `1`, false - `off` или `0`.
  3. _number_ - целые числа
  4. _double_ - вещественные числа

Вы также можете использовать множественное значение как массив для опций:

**Как взять значение опции из кода?**

Для этого взгляните на следующий пример:

    /** @var $config Configuration **/
    $config = Regenix::app()->config;
    
    $value = $config->get("option.name", "default.value");
    
    // вы также можете использовать типизированные методы
    
    $value = $config->getNumber("number.option", 123456);
    $value = $config->getBoolean("bool.option", false);
    $value = $config->getArray("multiple.option", array("a", "b"));


**Как делить опции на DEV и PROD режимы?**

Для этого вам необходимо использовать префикс в названиях опций,
это очень легко:

    dev.my.option = 123
    prod.my.option = 321

Как показано выше, мы имеем одну опцию, но два значения - для dev и prod рижимов.
Чтобы достать значение конфигурации вы должны использовать имя опции без префикса:

    // если приложение в dev режиме значит значени будет равно `123`, а в prod - `321`
    $value = $config->get("my.option");
    
Далее мы рассмотрим некоторые опции фреймворка из главного конфигурационного файла.

---

#### Правила приложения

По-умолчанию ваше приложение может быть открыто по адресу `http://<host>/`.
Существует опция, которая может изменить адрес вашего приложения - `app.rules`.

    app.rules = /

Значение `/` означает, что ваш сайт будет доступен по адресу `http://<любой_хост>/`.
Если вы измените значение на `/sub` (для примера), ваш сайт будет доступен по адресу `http://<любой_хост>/sub`.
Это опция может быть использована как префикс ко всем URL-ам вашего приложения.
Однако, эта опция может содержать также хост, домен и порт.

    app.rules = site.com/

Это позволяет сделать ваш сайт доступным только по домену `site.com`.
Также, эта опция поддерживает множественные значения, для примера:

    app.rules = site1.com/, site2.com/

Чтобы установить несколько правил, значение должно быть поделено запятыми. Если сделали это,
ваш сайт можно будет открывать по нескольким адресам.

> **ЗАМЕТКА**: Ваш сайт всегда будет использовать порт сервера по-умолчанию, но вы можете переопределить его.
> Для этого укажите ваш порт в адресе после домена: `site.com:port/`.

---

### Пространство имен приложения

Если вы хотите, чтобы все названия классов начинались с какого-то namespace, вы можете сделать это
через следующую опцию:

    app.namespace = <your_namespace_of_app>

Для примера:

    app.namespace = ru\regenix

и все классы в папке `src` вашего приложение должны начинатся с `ru\regenix` пространства имени:

    <?php
    namespace ru\regenix\controllers;

    class MainCtrl ...

---

#### Режим приложения

Regenix поддерживает 2 режима работы для приложений - `prod` и `dev`.

  1. **Продукт** (prod) - режим для продакшена, в этом режиме используются оптимизации и кеширование.
      Он имеет высокую производительность. Не используйте этот режим во время разработки.

  2. **Разработка** (dev) - режим разработки, он нужен во время разработки вашего приложения,
      он не использует кеширование и множество оптимизаций.

Читайте больше об этом в разделе _разработка_.

---

#### Строгий режим

Данный режим работы позволят вам не делать множества ошибок. Этот режим предупреждает
о многих вещах в вашем коде. PHP это не строгий язык, поэтому мы добавили эту опцию для
более безопасной разработки. В конфигурации это опция выглядит так:

    app.mode.strict = on
  
По-умолчанию опция включена. Режим применим только к исходникам приложения и не применим
к исходникам модулей, вендоров и фреймворка.

> ЗАМЕТКА: Мы строго рекомендуем включать это опцию в любых случаях.

--- 

#### Секретный код

Каждое приложение должно иметь свой собственный секретный код. Он используется
в некоторых местах фреймворка для безопастности. Данный код должен быть строкой
из случайных символов, для примера:

    app.secret = nlkJALJLJS309jl6876876kajllakjLLAKJkljalkjlaj

> Это опция обязательна.

---

## Логер

#### Включение логера

Следующая опция включает/отключает логер. По-умолчанию он включен.

    logger.enable = on/off
    
---

#### Разделенное логирование

Данная опция позволяет разделить вывод лог-сообщений на несколько файлов.
Используется уровень сообщения для того чтобы выбрать - в какой файл необходимо
писать сообщения.

    logger.division = on/off

Это может быть полезной функцией для поиска ошибок.

---

#### Уровень логирования

Это типичная опция для многих логеров. Уровень логера позволяет логировать
только некоторые сообщения в зависимости от их уровня.

    logger.level = debug/info/warn/error/fatal

Читайте больше об этой функции в разделе `logger`.

---

#### Логирование фатальных ошибок

Фатальные ошибки это специальный тип ошибок и поэтому они логируются
в отдельный файл под названием `fatal.log`. Эти ошибки могут происходить
если вы, например, ошиблик в синтаксисе. В основном, фатальные ошибки
случаются не во время выполнения.